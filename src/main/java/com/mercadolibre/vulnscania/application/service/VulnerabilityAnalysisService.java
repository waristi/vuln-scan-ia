package com.mercadolibre.vulnscania.application.service;

import com.mercadolibre.vulnscania.domain.port.output.IAServicePort;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public class VulnerabilityAnalysisService {
    private final IAServicePort iaServicePort;

    public String analyzeCode(String code, String language) {
        String systemPrompt = "Eres un experto en seguridad que analiza código. " +
                "Identifica vulnerabilidades de seguridad críticas.";

        String userPrompt = String.format(
                "Analiza el siguiente código %s:\n\n%s",
                language, code
        );
        return iaServicePort.generateResponse(systemPrompt, userPrompt);
    }

}

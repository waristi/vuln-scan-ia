package com.mercadolibre.vulnscania.domain.model.vulnerability;

/**
 * Estado del ciclo de vida de una vulnerabilidad.
 */
public enum VulnerabilityStatus {
    
    /**
     * Recién detectada, pendiente de análisis.
     */
    PENDING,
    
    /**
     * En proceso de análisis detallado.
     */
    UNDER_ANALYSIS,
    
    /**
     * Análisis completado, vulnerabilidad confirmada.
     */
    CONFIRMED,
    
    /**
     * Severidad crítica, requiere acción inmediata.
     */
    CRITICAL,
    
    /**
     * Mitigación aplicada o vulnerabilidad resuelta.
     */
    MITIGATED,
    
    /**
     * Evaluada como falso positivo.
     */
    FALSE_POSITIVE,
    
    /**
     * Vulnerabilidad aceptada como riesgo (excepción de negocio).
     */
    ACCEPTED_RISK,
    
    /**
     * Caso cerrado (mitigada, no aplicable, etc.).
     */
    CLOSED;
    
    /**
     * Determina si el estado requiere acción.
     */
    public boolean requiresAction() {
        return this == PENDING || this == UNDER_ANALYSIS || this == CRITICAL || this == CONFIRMED;
    }
    
    /**
     * Determina si el estado es final (no se puede modificar).
     */
    public boolean isFinal() {
        return this == CLOSED || this == FALSE_POSITIVE;
    }
    
    /**
     * Determina si se puede marcar como crítica desde este estado.
     */
    public boolean canMarkAsCritical() {
        return this == PENDING || this == UNDER_ANALYSIS || this == CONFIRMED;
    }
}


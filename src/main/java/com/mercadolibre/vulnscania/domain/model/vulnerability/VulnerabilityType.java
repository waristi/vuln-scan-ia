package com.mercadolibre.vulnscania.domain.model.vulnerability;

/**
 * Tipo de vulnerabilidad según CWE/clasificación común.
 * Ayuda a determinar el impacto y la mitigación apropiada.
 */
public enum VulnerabilityType {
    
    /**
     * Ejecución remota de código.
     */
    REMOTE_CODE_EXECUTION,
    
    /**
     * Inyección SQL.
     */
    SQL_INJECTION,
    
    /**
     * Cross-Site Scripting.
     */
    XSS,
    
    /**
     * Cross-Site Request Forgery.
     */
    CSRF,
    
    /**
     * Escalación de privilegios.
     */
    PRIVILEGE_ESCALATION,
    
    /**
     * Divulgación de información.
     */
    INFORMATION_DISCLOSURE,
    
    /**
     * Denegación de servicio.
     */
    DENIAL_OF_SERVICE,
    
    /**
     * Bypass de autenticación.
     */
    AUTHENTICATION_BYPASS,
    
    /**
     * Deserialización insegura.
     */
    INSECURE_DESERIALIZATION,
    
    /**
     * Path traversal.
     */
    PATH_TRAVERSAL,
    
    /**
     * Configuración insegura.
     */
    MISCONFIGURATION,
    
    /**
     * Dependencias con vulnerabilidades conocidas.
     */
    VULNERABLE_DEPENDENCY,
    
    /**
     * Otro tipo no clasificado.
     */
    OTHER;
    
    /**
     * Determina si el tipo implica ejecución de código.
     */
    public boolean impliesCodeExecution() {
        return this == REMOTE_CODE_EXECUTION 
            || this == SQL_INJECTION 
            || this == INSECURE_DESERIALIZATION;
    }
    
    /**
     * Determina si afecta la confidencialidad.
     */
    public boolean affectsConfidentiality() {
        return this == INFORMATION_DISCLOSURE 
            || this == SQL_INJECTION 
            || this == PATH_TRAVERSAL
            || this == AUTHENTICATION_BYPASS;
    }
}


package com.mercadolibre.vulnscania.domain.model.vulnerability;

/**
 * Nivel de severidad categórico de una vulnerabilidad.
 * Basado en CVSS score ranges.
 */
public enum SeverityLevel {
    
    /**
     * Score: 0.0
     */
    NONE(0.0, 0.0),
    
    /**
     * Score: 0.1 - 3.9
     */
    LOW(0.1, 3.9),
    
    /**
     * Score: 4.0 - 6.9
     */
    MEDIUM(4.0, 6.9),
    
    /**
     * Score: 7.0 - 8.9
     */
    HIGH(7.0, 8.9),
    
    /**
     * Score: 9.0 - 10.0
     */
    CRITICAL(9.0, 10.0);
    
    private final double minScore;
    private final double maxScore;
    
    SeverityLevel(double minScore, double maxScore) {
        this.minScore = minScore;
        this.maxScore = maxScore;
    }
    
    /**
     * Determina el nivel de severidad basado en el score.
     */
    public static SeverityLevel fromScore(double score) {
        if (score == 0.0) return NONE;
        if (score < 4.0) return LOW;
        if (score < 7.0) return MEDIUM;
        if (score < 9.0) return HIGH;
        return CRITICAL;
    }
    
    /**
     * Determina si este nivel es más severo que otro.
     */
    public boolean isMoreSevereThan(SeverityLevel other) {
        return this.ordinal() > other.ordinal();
    }
    
    public double getMinScore() {
        return minScore;
    }
    
    public double getMaxScore() {
        return maxScore;
    }
}


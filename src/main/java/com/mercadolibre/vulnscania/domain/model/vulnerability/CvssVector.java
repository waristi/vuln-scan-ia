package com.mercadolibre.vulnscania.domain.model.vulnerability;

import java.util.Objects;

/**
 * Value Object que representa un vector CVSS completo.
 * Ejemplo: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
 */
public record CvssVector(String value) {
    
    public CvssVector {
        Objects.requireNonNull(value, "CVSS Vector cannot be null");
        // Validación básica de formato (puede ser más estricta)
        if (!value.startsWith("CVSS:")) {
            throw new IllegalArgumentException("Invalid CVSS vector format: " + value);
        }
    }
    
    /**
     * Extrae la versión del CVSS (3.0, 3.1, 4.0, etc.).
     */
    public String getVersion() {
        String[] parts = value.split("/");
        if (parts.length > 0) {
            return parts[0].substring(5); // Después de "CVSS:"
        }
        return "unknown";
    }
    
    /**
     * Determina si es CVSS v3.x.
     */
    public boolean isVersion3() {
        return value.startsWith("CVSS:3.");
    }
}


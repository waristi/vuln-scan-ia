package com.mercadolibre.vulnscania.domain.port.output;

import com.mercadolibre.vulnscania.domain.model.vulnerability.CveId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.CvssVector;
import com.mercadolibre.vulnscania.domain.model.vulnerability.SeverityScore;

import java.util.Optional;

/**
 * Output Port: VulnerabilityCatalogPort
 * Define el contrato para obtener información de vulnerabilidades desde catálogos externos (NVD, etc.).
 */
public interface VulnerabilityCatalogPort {
    
    /**
     * Busca información de una vulnerabilidad por CVE ID.
     */
    Optional<VulnerabilityCatalogData> findByCveId(CveId cveId);
    
    /**
     * Verifica si un CVE existe en el catálogo.
     */
    boolean exists(CveId cveId);
    
    /**
     * DTO para datos del catálogo de vulnerabilidades.
     */
    record VulnerabilityCatalogData(
        CveId cveId,
        String description,
        SeverityScore baseScore,
        CvssVector cvssVector,
        String publishedDate,
        String lastModifiedDate
    ) {}
}

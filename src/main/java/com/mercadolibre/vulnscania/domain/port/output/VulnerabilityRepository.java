package com.mercadolibre.vulnscania.domain.port.output;

import com.mercadolibre.vulnscania.domain.model.application.ApplicationId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.CveId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.Vulnerability;
import com.mercadolibre.vulnscania.domain.model.vulnerability.VulnerabilityId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.VulnerabilityStatus;

import java.util.List;
import java.util.Optional;

/**
 * Output Port: VulnerabilityRepository
 * Define el contrato para persistencia de vulnerabilidades.
 */
public interface VulnerabilityRepository {
    
    Vulnerability save(Vulnerability vulnerability);
    
    Optional<Vulnerability> findById(VulnerabilityId id);
    
    Optional<Vulnerability> findByCveIdAndApplicationId(CveId cveId, ApplicationId applicationId);
    
    List<Vulnerability> findByApplicationId(ApplicationId applicationId);
    
    List<Vulnerability> findByStatus(VulnerabilityStatus status);
    
    List<Vulnerability> findCriticalVulnerabilities();
    
    void deleteById(VulnerabilityId id);
    
    boolean existsByCveIdAndApplicationId(CveId cveId, ApplicationId applicationId);
}


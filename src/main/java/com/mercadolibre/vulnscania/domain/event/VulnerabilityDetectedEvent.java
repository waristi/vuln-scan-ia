package com.mercadolibre.vulnscania.domain.event;

import com.mercadolibre.vulnscania.domain.model.application.ApplicationId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.CveId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.SeverityScore;
import com.mercadolibre.vulnscania.domain.model.vulnerability.VulnerabilityId;

import java.time.Instant;
import java.util.Objects;

/**
 * Evento: VulnerabilityDetectedEvent
 * Se dispara cuando se detecta una nueva vulnerabilidad en una aplicaci√≥n.
 */
public record VulnerabilityDetectedEvent(
    VulnerabilityId vulnerabilityId,
    CveId cveId,
    ApplicationId applicationId,
    SeverityScore baseScore,
    Instant occurredAt
) implements DomainEvent {
    
    public VulnerabilityDetectedEvent {
        Objects.requireNonNull(vulnerabilityId, "Vulnerability ID cannot be null");
        Objects.requireNonNull(cveId, "CVE ID cannot be null");
        Objects.requireNonNull(applicationId, "Application ID cannot be null");
        Objects.requireNonNull(baseScore, "Base score cannot be null");
        Objects.requireNonNull(occurredAt, "Occurred at cannot be null");
    }
}


package com.mercadolibre.vulnscania.domain.event;

import com.mercadolibre.vulnscania.domain.model.application.ApplicationId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.CveId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.SeverityScore;
import com.mercadolibre.vulnscania.domain.model.vulnerability.VulnerabilityId;

import java.time.Instant;
import java.util.Objects;

/**
 * Evento: VulnerabilityCriticalEvent
 * Se dispara cuando una vulnerabilidad es marcada como crítica.
 * Típicamente requiere notificaciones inmediatas (email, Slack, PagerDuty, etc.).
 */
public record VulnerabilityCriticalEvent(
    VulnerabilityId vulnerabilityId,
    CveId cveId,
    ApplicationId applicationId,
    SeverityScore contextualScore,
    String reason,
    Instant occurredAt
) implements DomainEvent {
    
    public VulnerabilityCriticalEvent {
        Objects.requireNonNull(vulnerabilityId, "Vulnerability ID cannot be null");
        Objects.requireNonNull(cveId, "CVE ID cannot be null");
        Objects.requireNonNull(applicationId, "Application ID cannot be null");
        Objects.requireNonNull(contextualScore, "Contextual score cannot be null");
        Objects.requireNonNull(reason, "Reason cannot be null");
        Objects.requireNonNull(occurredAt, "Occurred at cannot be null");
    }
}


package com.mercadolibre.vulnscania.domain.command;

import com.mercadolibre.vulnscania.domain.model.application.ApplicationId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.CveId;

import java.util.Objects;

/**
 * Command to evaluate a vulnerability for a specific application.
 * 
 * Immutable record following the Command Pattern.
 * Commands represent user intentions and are used to decouple
 * the API layer from the domain layer.
 * 
 * @param cveId CVE identifier to evaluate
 * @param applicationId Application that may be affected
 * @param useAIAnalysis Whether to use AI analysis
 * @param aiProvider Optional AI provider to use for analysis (openai, claude, gemini)
 */
public record EvaluateVulnerabilityCommand(
    CveId cveId,
    ApplicationId applicationId,
    boolean useAIAnalysis,
    String aiProvider
) {
    
    public EvaluateVulnerabilityCommand {
        Objects.requireNonNull(cveId, "CVE ID is required");
        Objects.requireNonNull(applicationId, "Application ID is required");
    }
    
    /**
     * Constructor with AI analysis enabled and no specific provider (uses default).
     */
    public EvaluateVulnerabilityCommand(CveId cveId, ApplicationId applicationId) {
        this(cveId, applicationId, true, null);
    }
    
    /**
     * Constructor with AI analysis flag but no specific provider.
     */
    public EvaluateVulnerabilityCommand(CveId cveId, ApplicationId applicationId, boolean useAIAnalysis) {
        this(cveId, applicationId, useAIAnalysis, null);
    }
}

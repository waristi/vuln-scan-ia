package com.mercadolibre.vulnscania.domain.command;

import com.mercadolibre.vulnscania.domain.model.application.ApplicationId;
import com.mercadolibre.vulnscania.domain.model.vulnerability.CveId;

import java.util.Objects;

/**
 * Command: EvaluateVulnerabilityCommand
 * 
 * Represents the intention to evaluate a vulnerability in the context of an application.
 * The evaluation combines deterministic scoring with optional AI analysis.
 */
public record EvaluateVulnerabilityCommand(
    CveId cveId,
    ApplicationId applicationId,
    boolean useAIAnalysis
) {
    
    public EvaluateVulnerabilityCommand {
        Objects.requireNonNull(cveId, "CVE ID is required");
        Objects.requireNonNull(applicationId, "Application ID is required");
    }
    
    /**
     * Convenience constructor with AI analysis enabled by default.
     *
     * @param cveId the CVE identifier
     * @param applicationId the application identifier
     */
    public EvaluateVulnerabilityCommand(CveId cveId, ApplicationId applicationId) {
        this(cveId, applicationId, true);
    }
}


package com.mercadolibre.vulnscania.infrastructure.adapter.input.rest.dto;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Pattern;

/**
 * REST API DTO for vulnerability evaluation request.
 */
public record EvaluateVulnerabilityRequest(
    
    @NotBlank(message = "CVE ID is required")
    @Pattern(regexp = "^CVE-\\d{4}-\\d{4,}$", message = "Invalid CVE ID format. Expected: CVE-YYYY-NNNNN")
    String cveId,
    
    @NotBlank(message = "Application ID is required")
    String applicationId,
    
    Boolean useAIAnalysis
) {
    public EvaluateVulnerabilityRequest {
        // Default useAIAnalysis to true if not provided
        if (useAIAnalysis == null) {
            useAIAnalysis = true;
        }
    }
}


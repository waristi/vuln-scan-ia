@startuml C4_Container
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

title Container Diagram - VulnScan IA

Person(user, "User", "Security analyst, developer, or admin")

System_Ext(openai, "OpenAI API")
System_Ext(claude, "Claude API")
System_Ext(gemini, "Gemini API")
System_Ext(nvd_api, "NVD API")

System_Boundary(c1, "VulnScan IA System") {
    Container(web_app, "Web Application", "Spring Boot", "REST API with JWT authentication, Swagger UI")
    ContainerDb(mongodb, "MongoDB", "Document Database", "Stores applications, users, vulnerabilities, and assessments")
}

Rel(user, web_app, "Uses", "HTTPS/REST API")
Rel(web_app, mongodb, "Reads from and writes to", "MongoDB Protocol")
Rel(web_app, openai, "Fetches AI analysis", "HTTPS")
Rel(web_app, claude, "Fetches AI analysis", "HTTPS")
Rel(web_app, gemini, "Fetches AI analysis", "HTTPS")
Rel(web_app, nvd_api, "Fetches CVE data", "HTTPS")

@enduml

